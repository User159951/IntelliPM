# Internationalization (i18n) Documentation

**Version:** 1.0.0  
**Last Updated:** January 2025

---

## Table of Contents

1. [Overview](#overview)
2. [Architecture](#architecture)
3. [Translation Files](#translation-files)
4. [Using Translations](#using-translations)
5. [Adding a New Language](#adding-a-new-language)
6. [Adding Translations to a Component](#adding-translations-to-a-component)
7. [Key Naming Conventions](#key-naming-conventions)
8. [Common Patterns](#common-patterns)
9. [Date and Number Formatting](#date-and-number-formatting)
10. [Troubleshooting](#troubleshooting)
11. [Performance Considerations](#performance-considerations)

---

## 1. Overview

IntelliPM uses **react-i18next** for internationalization, providing a robust and flexible translation system. The implementation supports:

- **Multiple Languages**: Currently English (en) and French (fr)
- **Namespace Organization**: Translations organized by feature/domain
- **Dynamic Language Switching**: Users can change language at runtime
- **Backend Synchronization**: Language preference synced with user settings
- **Automatic Detection**: Browser language detection with fallback
- **Date/Number Formatting**: Locale-aware formatting utilities

### Key Features

- âœ… **18 Namespaces**: Organized by feature (common, auth, projects, tasks, etc.)
- âœ… **Language Context**: React context for language management
- âœ… **Custom Hook**: Enhanced `useTranslation` hook with safe fallbacks
- âœ… **Type Safety**: TypeScript support for translation keys
- âœ… **Lazy Loading**: Translation files loaded on demand
- âœ… **Validation Script**: Automated translation key validation

---

## 2. Architecture

### 2.1 Core Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         LanguageContext                  â”‚
â”‚  (Language state, changeLanguage)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         i18n Configuration               â”‚
â”‚  (react-i18next, HttpBackend)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Translation Files (JSON)            â”‚
â”‚  /public/locales/{lang}/{ns}.json       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 File Structure

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ i18n/
â”‚   â”‚   â””â”€â”€ config.ts              # i18n configuration
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â””â”€â”€ LanguageContext.tsx    # Language context provider
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useTranslation.ts     # Custom translation hook
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ dateFormat.ts         # Date formatting utilities
â”‚   â”‚   â””â”€â”€ numberFormat.ts       # Number formatting utilities
â”‚   â””â”€â”€ components/
â”‚       â””â”€â”€ layout/
â”‚           â””â”€â”€ LanguageToggle.tsx # Language switcher component
â”‚
â””â”€â”€ public/
    â””â”€â”€ locales/
        â”œâ”€â”€ en/                    # English translations
        â”‚   â”œâ”€â”€ common.json
        â”‚   â”œâ”€â”€ auth.json
        â”‚   â”œâ”€â”€ projects.json
        â”‚   â””â”€â”€ ...
        â””â”€â”€ fr/                    # French translations
            â”œâ”€â”€ common.json
            â”œâ”€â”€ auth.json
            â”œâ”€â”€ projects.json
            â””â”€â”€ ...
```

### 2.3 Namespaces

The following namespaces are configured:

1. **common** - Common UI elements (buttons, labels, messages)
2. **auth** - Authentication and authorization
3. **projects** - Project management
4. **tasks** - Task management
5. **admin** - Administration
6. **navigation** - Navigation menu items
7. **notifications** - Notification messages
8. **errors** - Error messages
9. **dashboard** - Dashboard components
10. **sprints** - Sprint management
11. **teams** - Team management
12. **backlog** - Backlog management
13. **defects** - Defect tracking
14. **metrics** - Metrics and analytics
15. **insights** - Project insights
16. **agents** - AI agents
17. **milestones** - Milestone tracking
18. **releases** - Release management

---

## 3. Translation Files

### 3.1 File Location

Translation files are located in:
- **Development**: `frontend/src/locales/{lang}/{ns}.json`
- **Production**: `frontend/public/locales/{lang}/{ns}.json`

The `public/locales` directory is used at runtime, while `src/locales` may contain source files that are copied during build.

### 3.2 File Structure

Translation files are JSON objects with nested keys:

```json
{
  "title": "Projects",
  "description": "Manage your project portfolio",
  "create": {
    "button": "Create Project",
    "title": "Create new project",
    "description": "Set up a new project to start tracking your work."
  },
  "form": {
    "name": "Project name",
    "namePlaceholder": "Enter project name",
    "status": "Status *",
    "statusRequired": "Status is required"
  }
}
```

### 3.3 Interpolation

Use `{{variable}}` for dynamic values:

```json
{
  "showing": "Showing {{count}} of {{total}} projects",
  "welcome": "Welcome, {{name}}!"
}
```

### 3.4 Pluralization

i18next supports pluralization:

```json
{
  "task": "{{count}} task",
  "task_plural": "{{count}} tasks"
}
```

In French:
```json
{
  "task": "{{count}} tÃ¢che",
  "task_plural": "{{count}} tÃ¢ches"
}
```

---

## 4. Using Translations

### 4.1 Basic Usage

```typescript
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('common.welcome')}</h1>
      <p>{t('projects.description')}</p>
    </div>
  );
}
```

### 4.2 With Namespace

```typescript
import { useTranslation } from 'react-i18next';

function ProjectList() {
  const { t } = useTranslation('projects');
  
  return (
    <div>
      <h1>{t('title')}</h1>
      <p>{t('description')}</p>
    </div>
  );
}
```

### 4.3 Multiple Namespaces

```typescript
const { t } = useTranslation(['projects', 'common']);

// Use with namespace prefix
<h1>{t('projects:title')}</h1>
<button>{t('common:save')}</button>
```

### 4.4 With Interpolation

```typescript
const { t } = useTranslation('projects');

// Simple interpolation
<p>{t('showing', { count: 5, total: 10 })}</p>
// Output: "Showing 5 of 10 projects"
```

### 4.5 Safe Translation (with Fallback)

The custom `useTranslation` hook provides a `safeT` function that returns a fallback if the key is missing:

```typescript
const { safeT } = useTranslation();

// If key is missing, returns fallback
const text = safeT('common.newKey', 'New Key');
```

### 4.6 Language Context

Access language state and change language:

```typescript
import { useLanguage } from '@/contexts/LanguageContext';

function LanguageSwitcher() {
  const { language, changeLanguage, availableLanguages } = useLanguage();
  
  return (
    <select value={language} onChange={(e) => changeLanguage(e.target.value)}>
      {availableLanguages.map(lang => (
        <option key={lang.code} value={lang.code}>
          {lang.label}
        </option>
      ))}
    </select>
  );
}
```

---

## 5. Adding a New Language

### 5.1 Step 1: Update i18n Configuration

Edit `frontend/src/i18n/config.ts`:

```typescript
i18n.init({
  supportedLngs: ['en', 'fr', 'es'], // Add 'es' for Spanish
  fallbackLng: 'en',
  // ... rest of config
});
```

### 5.2 Step 2: Add Language to Context

Edit `frontend/src/contexts/LanguageContext.tsx`:

```typescript
const AVAILABLE_LANGUAGES: Language[] = [
  { code: 'en', label: 'English' },
  { code: 'fr', label: 'FranÃ§ais' },
  { code: 'es', label: 'EspaÃ±ol' }, // Add Spanish
];
```

### 5.3 Step 3: Create Translation Files

Create translation files for all namespaces:

```bash
# Create directory structure
mkdir -p frontend/public/locales/es

# Copy structure from English and translate
cp frontend/public/locales/en/*.json frontend/public/locales/es/
```

### 5.4 Step 4: Update Date/Number Formatting

Edit `frontend/src/utils/dateFormat.ts`:

```typescript
import { es } from 'date-fns/locale';

export function getDateLocale(language: string): Locale {
  switch (language.toLowerCase()) {
    case 'fr':
      return fr;
    case 'es':
      return es; // Add Spanish locale
    case 'en':
    default:
      return enUS;
  }
}
```

Edit `frontend/src/utils/numberFormat.ts`:

```typescript
function getFullLocale(language: string): string {
  switch (language.toLowerCase()) {
    case 'fr':
      return 'fr-FR';
    case 'es':
      return 'es-ES'; // Add Spanish locale
    case 'en':
    default:
      return 'en-US';
  }
}
```

### 5.5 Step 5: Update Language Toggle

Edit `frontend/src/components/layout/LanguageToggle.tsx`:

```typescript
const LANGUAGE_OPTIONS = [
  { code: 'en', label: 'English', flag: 'ğŸ‡¬ğŸ‡§' },
  { code: 'fr', label: 'FranÃ§ais', flag: 'ğŸ‡«ğŸ‡·' },
  { code: 'es', label: 'EspaÃ±ol', flag: 'ğŸ‡ªğŸ‡¸' }, // Add Spanish
] as const;
```

### 5.6 Step 6: Validate Translations

Run the validation script to ensure all keys are present:

```bash
npm run i18n:check
```

---

## 6. Adding Translations to a Component

### 6.1 Step-by-Step Guide

#### Step 1: Identify Text to Translate

```typescript
function MyComponent() {
  return (
    <div>
      <h1>Welcome</h1>
      <p>This is a sample component</p>
      <button>Click me</button>
    </div>
  );
}
```

#### Step 2: Choose Appropriate Namespace

- Use `common` for generic UI elements
- Use feature-specific namespace (e.g., `projects`, `tasks`) for feature content
- Use `errors` for error messages
- Use `notifications` for notification messages

#### Step 3: Add Translation Keys

Add keys to the appropriate namespace file:

**`public/locales/en/common.json`:**
```json
{
  "welcome": "Welcome",
  "sampleComponent": "This is a sample component",
  "clickMe": "Click me"
}
```

**`public/locales/fr/common.json`:**
```json
{
  "welcome": "Bienvenue",
  "sampleComponent": "Ceci est un composant d'exemple",
  "clickMe": "Cliquez-moi"
}
```

#### Step 4: Use Translation in Component

```typescript
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation('common');
  
  return (
    <div>
      <h1>{t('welcome')}</h1>
      <p>{t('sampleComponent')}</p>
      <button>{t('clickMe')}</button>
    </div>
  );
}
```

### 6.2 Best Practices

1. **Group Related Keys**: Use nested objects for related translations
   ```json
   {
     "form": {
       "name": "Name",
       "email": "Email",
       "submit": "Submit"
     }
   }
   ```

2. **Use Descriptive Keys**: Make keys self-documenting
   ```json
   // Good
   "createProjectButton": "Create Project"
   
   // Bad
   "btn1": "Create Project"
   ```

3. **Reuse Common Keys**: Use `common` namespace for reusable text
   ```json
   // common.json
   {
     "save": "Save",
     "cancel": "Cancel",
     "delete": "Delete"
   }
   ```

4. **Handle Dynamic Content**: Use interpolation for dynamic values
   ```typescript
   t('projects.showing', { count: 5, total: 10 })
   ```

---

## 7. Key Naming Conventions

### 7.1 Structure

Keys follow a hierarchical structure:

```
{namespace}.{section}.{item}
```

Examples:
- `common.save` - Common save button
- `projects.create.button` - Project create button
- `tasks.form.name` - Task form name field
- `errors.validation.required` - Validation error

### 7.2 Naming Patterns

#### Buttons
- `{action}Button` or `{action}.button`
  - `createButton` or `create.button`
  - `saveButton` or `save.button`
  - `deleteButton` or `delete.button`

#### Form Fields
- `{field}` or `form.{field}`
  - `name` or `form.name`
  - `email` or `form.email`
  - `namePlaceholder` or `form.namePlaceholder`

#### Messages
- `{type}Message` or `{type}.message`
  - `successMessage` or `success.message`
  - `errorMessage` or `error.message`
  - `warningMessage` or `warning.message`

#### Titles and Labels
- `{item}Title` or `{item}.title`
- `{item}Label` or `{item}.label`
  - `pageTitle` or `page.title`
  - `sectionLabel` or `section.label`

### 7.3 Common Prefixes/Suffixes

- `Placeholder` - Input placeholders
- `Required` - Required field indicators
- `Tooltip` - Tooltip text
- `AriaLabel` - Accessibility labels
- `Description` - Descriptions/help text
- `Empty` - Empty state messages

---

## 8. Common Patterns

### 8.1 Form Translations

```json
{
  "form": {
    "name": "Name",
    "namePlaceholder": "Enter name",
    "nameRequired": "Name is required",
    "email": "Email",
    "emailPlaceholder": "Enter email",
    "emailInvalid": "Invalid email address",
    "submit": "Submit",
    "cancel": "Cancel"
  }
}
```

Usage:
```typescript
const { t } = useTranslation('common');

<FormField>
  <FormLabel>{t('form.name')}</FormLabel>
  <FormControl>
    <Input placeholder={t('form.namePlaceholder')} />
  </FormControl>
  <FormMessage>{t('form.nameRequired')}</FormMessage>
</FormField>
```

### 8.2 Empty States

```json
{
  "empty": {
    "title": "No items found",
    "message": "Get started by creating your first item",
    "button": "Create Item"
  }
}
```

Usage:
```typescript
const { t } = useTranslation('projects');

{items.length === 0 && (
  <EmptyState>
    <h3>{t('empty.title')}</h3>
    <p>{t('empty.message')}</p>
    <Button>{t('empty.button')}</Button>
  </EmptyState>
)}
```

### 8.3 Error Messages

```json
{
  "errors": {
    "notFound": "Resource not found",
    "unauthorized": "You are not authorized to perform this action",
    "validation": {
      "required": "This field is required",
      "minLength": "Must be at least {{min}} characters",
      "maxLength": "Must be no more than {{max}} characters"
    }
  }
}
```

Usage:
```typescript
const { t } = useTranslation('errors');

{error && (
  <Alert variant="destructive">
    {t('errors.notFound')}
  </Alert>
)}
```

### 8.4 Confirmation Dialogs

```json
{
  "confirm": {
    "delete": {
      "title": "Delete Item",
      "message": "Are you sure you want to delete this item? This action cannot be undone.",
      "confirm": "Delete",
      "cancel": "Cancel"
    }
  }
}
```

Usage:
```typescript
const { t } = useTranslation('common');

const handleDelete = () => {
  Swal.fire({
    title: t('confirm.delete.title'),
    text: t('confirm.delete.message'),
    confirmButtonText: t('confirm.delete.confirm'),
    cancelButtonText: t('confirm.delete.cancel'),
    // ...
  });
};
```

### 8.5 Status Labels

```json
{
  "status": {
    "active": "Active",
    "inactive": "Inactive",
    "pending": "Pending",
    "completed": "Completed",
    "cancelled": "Cancelled"
  }
}
```

---

## 9. Date and Number Formatting

### 9.1 Date Formatting

Use the `formatDate` utility for locale-aware date formatting:

```typescript
import { formatDate, DateFormats } from '@/utils/dateFormat';
import { useLanguage } from '@/contexts/LanguageContext';

function DateDisplay({ date }: { date: Date }) {
  const { language } = useLanguage();
  
  // Short date: "01/08/2026" (US) or "08/01/2026" (FR)
  const shortDate = formatDate(date, DateFormats.SHORT(language), language);
  
  // Long date: "January 8, 2026" (US) or "8 janvier 2026" (FR)
  const longDate = formatDate(date, DateFormats.LONG(language), language);
  
  // Relative time: "2 hours ago" or "il y a 2 heures"
  const relative = formatRelativeTime(date, language);
  
  return <div>{longDate}</div>;
}
```

### 9.2 Number Formatting

Use the `formatNumber` utility for locale-aware number formatting:

```typescript
import { formatNumber, formatCurrency, formatPercentage } from '@/utils/numberFormat';
import { useLanguage } from '@/contexts/LanguageContext';

function NumberDisplay({ value }: { value: number }) {
  const { language } = useLanguage();
  
  // Formatted number: "1,234.56" (US) or "1 234,56" (FR)
  const formatted = formatNumber(value, language);
  
  // Currency: "$1,234.56" (US) or "1 234,56 â‚¬" (FR)
  const currency = formatCurrency(value, language, 'USD');
  
  // Percentage: "45.5%" (US) or "45,5 %" (FR)
  const percentage = formatPercentage(value, language);
  
  return <div>{formatted}</div>;
}
```

### 9.3 Available Format Presets

**Date Formats:**
- `DateFormats.SHORT(language)` - Short date
- `DateFormats.LONG(language)` - Long date
- `DateFormats.DATETIME(language)` - Date with time
- `DateFormats.TIME(language)` - Time only
- `DateFormats.MONTH_DAY(language)` - Month and day
- `DateFormats.DAY_OF_WEEK(language)` - Day of week
- `DateFormats.PRETTY(language)` - Pretty print

**Number Formats:**
- `NumberFormats.INTEGER(locale)` - Integer (no decimals)
- `NumberFormats.DECIMAL_1(number, locale)` - 1 decimal place
- `NumberFormats.DECIMAL_2(number, locale)` - 2 decimal places
- `NumberFormats.PERCENTAGE_1(number, locale)` - Percentage (1 decimal)
- `NumberFormats.PERCENTAGE_2(number, locale)` - Percentage (2 decimals)

---

## 10. Troubleshooting

### 10.1 Translation Key Not Found

**Problem:** Translation key returns the key itself (e.g., `common.newKey`)

**Solutions:**
1. Check that the key exists in the translation file
2. Verify the namespace is correct
3. Ensure the file is in the correct location (`public/locales/{lang}/{ns}.json`)
4. Check for typos in the key name
5. Use `safeT` for fallback values:
   ```typescript
   const { safeT } = useTranslation();
   const text = safeT('common.newKey', 'Fallback Text');
   ```

### 10.2 Language Not Changing

**Problem:** Language doesn't change when using `changeLanguage`

**Solutions:**
1. Check that the language code is in `supportedLngs`
2. Verify `LanguageProvider` wraps your component
3. Check browser console for errors
4. Verify translation files exist for the language
5. Clear browser cache and localStorage

### 10.3 Missing Translation Files

**Problem:** Translations not loading

**Solutions:**
1. Verify files are in `public/locales/{lang}/{ns}.json`
2. Check file names match namespace names exactly
3. Ensure JSON files are valid (no syntax errors)
4. Check network tab for 404 errors
5. Verify `loadPath` in i18n config matches file structure

### 10.4 Date/Number Formatting Issues

**Problem:** Dates or numbers not formatting correctly

**Solutions:**
1. Verify language code is passed correctly
2. Check that locale is supported in `date-fns` or `Intl`
3. Ensure `getDateLocale` or `getFullLocale` includes the language
4. Check browser console for errors

### 10.5 Namespace Not Loading

**Problem:** Namespace translations not available

**Solutions:**
1. Verify namespace is in `ns` array in `i18n/config.ts`
2. Check that translation file exists for the namespace
3. Ensure namespace is specified in `useTranslation` hook
4. Check for typos in namespace name

### 10.6 Backend Language Sync Issues

**Problem:** Language preference not syncing with backend

**Solutions:**
1. Check that user is authenticated
2. Verify API endpoint is correct (`/api/v1/Settings`)
3. Check network tab for API errors
4. Verify backend supports language setting
5. Language change still works locally even if backend fails

---

## 11. Performance Considerations

### 11.1 Lazy Loading

Translation files are loaded on demand via `HttpBackend`. This means:
- Only required namespaces are loaded initially
- Additional namespaces load when first used
- Reduces initial bundle size

### 11.2 Caching

i18next caches loaded translations:
- Translations are cached in memory
- No need to reload on every render
- Language changes trigger reload only when necessary

### 11.3 Bundle Size

- Translation files are not included in the main bundle
- Files are served as static assets
- Only loaded when needed

### 11.4 Best Practices

1. **Use Namespaces Wisely**: Load only necessary namespaces
   ```typescript
   // Good: Load only projects namespace
   const { t } = useTranslation('projects');
   
   // Avoid: Loading all namespaces
   const { t } = useTranslation();
   ```

2. **Avoid Dynamic Keys**: Use static keys when possible
   ```typescript
   // Good
   t('common.save')
   
   // Avoid
   t(`common.${action}`)
   ```

3. **Cache Language**: Language preference is cached in localStorage
4. **Minimize Re-renders**: Language changes trigger re-renders only where needed

---

## Additional Resources

- [react-i18next Documentation](https://react.i18next.com/)
- [i18next Documentation](https://www.i18next.com/)
- [Translation Contribution Guide](./TRANSLATION_GUIDE.md)
- [i18n Checklist](./i18n-checklist.md)

---

**Last Updated:** January 2025

